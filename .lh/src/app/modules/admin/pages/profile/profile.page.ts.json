{
    "sourceFile": "src/app/modules/admin/pages/profile/profile.page.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1763885282732,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1763885776746,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,31 +66,8 @@\n       this.loading = false;\r\n     }\r\n   }\r\n \r\n-  async logout() {\r\n-    const alert = await this.alertController.create({\r\n-      header: 'Sign Out',\r\n-      message: 'Are you sure you want to sign out?',\r\n-      buttons: [\r\n-        {\r\n-          text: 'Cancel',\r\n-          role: 'cancel'\r\n-        },\r\n-        {\r\n-          text: 'Sign Out',\r\n-          role: 'confirm',\r\n-          handler: async () => {\r\n-            await this.authService.signOut();\r\n-            this.router.navigate(['/landing']);\r\n-          }\r\n-        }\r\n-      ]\r\n-    });\r\n-\r\n-    await alert.present();\r\n-  }\r\n-\r\n   onImageError(event: any) {\r\n     event.target.style.display = 'none';\r\n   }\r\n }\r\n"
                },
                {
                    "date": 1763888577872,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,16 +35,32 @@\n     this.editing = !this.editing;\r\n   }\r\n \r\n   async saveProfile() {\r\n-    if (!this.user) return;\r\n+    if (!this.user || !this.user.userId) {\r\n+      const toast = await this.toastController.create({\r\n+        message: 'User information not available',\r\n+        duration: 2000,\r\n+        color: 'danger',\r\n+        position: 'top'\r\n+      });\r\n+      await toast.present();\r\n+      return;\r\n+    }\r\n     \r\n     this.loading = true;\r\n     try {\r\n-      await this.userService.updateUserProfile(this.user.userId!, {\r\n+      console.log('Updating profile for user:', this.user.userId);\r\n+      \r\n+      await this.userService.updateUserProfile(this.user.userId, {\r\n         name: this.user.name,\r\n         phone: this.user.phone\r\n       });\r\n+      \r\n+      // Refresh the user data from AuthService\r\n+      await this.authService.refreshCurrentUser();\r\n+      this.user = this.authService.getCurrentUser();\r\n+      \r\n       this.editing = false;\r\n       \r\n       const toast = await this.toastController.create({\r\n         message: 'Profile updated successfully!',\r\n@@ -52,12 +68,12 @@\n         color: 'success',\r\n         position: 'top'\r\n       });\r\n       await toast.present();\r\n-    } catch (error) {\r\n+    } catch (error: any) {\r\n       console.error('Error saving profile:', error);\r\n       const toast = await this.toastController.create({\r\n-        message: 'Failed to update profile. Please try again.',\r\n+        message: `Failed to update profile: ${error.message || 'Please try again'}`,\r\n         duration: 3000,\r\n         color: 'danger',\r\n         position: 'top'\r\n       });\r\n"
                },
                {
                    "date": 1763889659864,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,10 +28,17 @@\n   ) { }\r\n \r\n   ngOnInit() {\r\n     this.user = this.authService.getCurrentUser();\r\n+    console.log('Admin Profile: Current user loaded:', this.user);\r\n   }\r\n \r\n+  ionViewWillEnter() {\r\n+    // Refresh user data when entering page\r\n+    this.user = this.authService.getCurrentUser();\r\n+    console.log('Admin Profile: User refreshed:', this.user);\r\n+  }\r\n+\r\n   toggleEdit() {\r\n     this.editing = !this.editing;\r\n   }\r\n \r\n@@ -48,18 +55,27 @@\n     }\r\n     \r\n     this.loading = true;\r\n     try {\r\n-      console.log('Updating profile for user:', this.user.userId);\r\n+      console.log('Admin Profile: Starting update...');\r\n+      console.log('Admin Profile: User ID:', this.user.userId);\r\n+      console.log('Admin Profile: Name:', this.user.name);\r\n+      console.log('Admin Profile: Phone:', this.user.phone);\r\n       \r\n-      await this.userService.updateUserProfile(this.user.userId, {\r\n+      const updateData = {\r\n         name: this.user.name,\r\n         phone: this.user.phone\r\n-      });\r\n+      };\r\n       \r\n+      console.log('Admin Profile: Calling updateUserProfile with:', updateData);\r\n+      await this.userService.updateUserProfile(this.user.userId, updateData);\r\n+      console.log('Admin Profile: Update completed');\r\n+      \r\n       // Refresh the user data from AuthService\r\n+      console.log('Admin Profile: Refreshing current user...');\r\n       await this.authService.refreshCurrentUser();\r\n       this.user = this.authService.getCurrentUser();\r\n+      console.log('Admin Profile: User data refreshed:', this.user);\r\n       \r\n       this.editing = false;\r\n       \r\n       const toast = await this.toastController.create({\r\n"
                }
            ],
            "date": 1763885282731,
            "name": "Commit-0",
            "content": "import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule, AlertController, ToastController } from '@ionic/angular';\r\nimport { Router } from '@angular/router';\r\nimport { AuthService } from '../../../../services/auth.service';\r\nimport { UserService } from '../../../../services/user.service';\r\nimport { User } from '../../../../models/user.model';\r\n\r\n@Component({\r\n  selector: 'app-profile',\r\n  templateUrl: './profile.page.html',\r\n  styleUrls: ['./profile.page.scss'],\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, IonicModule]\r\n})\r\nexport class ProfilePage implements OnInit {\r\n  user: User | null = null;\r\n  loading: boolean = false;\r\n  editing: boolean = false;\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private userService: UserService,\r\n    private router: Router,\r\n    private alertController: AlertController,\r\n    private toastController: ToastController\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.user = this.authService.getCurrentUser();\r\n  }\r\n\r\n  toggleEdit() {\r\n    this.editing = !this.editing;\r\n  }\r\n\r\n  async saveProfile() {\r\n    if (!this.user) return;\r\n    \r\n    this.loading = true;\r\n    try {\r\n      await this.userService.updateUserProfile(this.user.userId!, {\r\n        name: this.user.name,\r\n        phone: this.user.phone\r\n      });\r\n      this.editing = false;\r\n      \r\n      const toast = await this.toastController.create({\r\n        message: 'Profile updated successfully!',\r\n        duration: 2000,\r\n        color: 'success',\r\n        position: 'top'\r\n      });\r\n      await toast.present();\r\n    } catch (error) {\r\n      console.error('Error saving profile:', error);\r\n      const toast = await this.toastController.create({\r\n        message: 'Failed to update profile. Please try again.',\r\n        duration: 3000,\r\n        color: 'danger',\r\n        position: 'top'\r\n      });\r\n      await toast.present();\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  async logout() {\r\n    const alert = await this.alertController.create({\r\n      header: 'Sign Out',\r\n      message: 'Are you sure you want to sign out?',\r\n      buttons: [\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel'\r\n        },\r\n        {\r\n          text: 'Sign Out',\r\n          role: 'confirm',\r\n          handler: async () => {\r\n            await this.authService.signOut();\r\n            this.router.navigate(['/landing']);\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n  }\r\n\r\n  onImageError(event: any) {\r\n    event.target.style.display = 'none';\r\n  }\r\n}\r\n"
        }
    ]
}