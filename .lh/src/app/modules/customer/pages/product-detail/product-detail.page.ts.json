{
    "sourceFile": "src/app/modules/customer/pages/product-detail/product-detail.page.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1763390046038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1763390084705,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,9 +25,11 @@\n   constructor(\r\n     private route: ActivatedRoute,\r\n     private router: Router,\r\n     private productService: ProductService,\r\n-    private cartService: CartService\r\n+    private cartService: CartService,\r\n+    private chatService: ChatService,\r\n+    private authService: AuthService\r\n   ) { }\r\n \r\n   ngOnInit() {\r\n     const productId = this.route.snapshot.paramMap.get('id');\r\n@@ -82,9 +84,39 @@\n       console.error('Error adding to cart:', error);\r\n     }\r\n   }\r\n \r\n+  async messageSeller() {\r\n+    if (!this.product) return;\r\n+    \r\n+    const user = this.authService.getCurrentUser();\r\n+    if (!user) {\r\n+      this.router.navigate(['/auth/login']);\r\n+      return;\r\n+    }\r\n+\r\n+    try {\r\n+      const chatId = await this.chatService.getOrCreateChat(\r\n+        user.userId!,\r\n+        this.product.sellerId,\r\n+        {\r\n+          name: user.name || user.email,\r\n+          role: user.role,\r\n+          profileImage: user.profileImage\r\n+        },\r\n+        {\r\n+          name: this.product.sellerName,\r\n+          role: 'seller'\r\n+        }\r\n+      );\r\n+      this.router.navigate([`/customer/chat/${chatId}`]);\r\n+    } catch (error) {\r\n+      console.error('Error creating chat:', error);\r\n+    }\r\n+  }\r\n+\r\n   goBack() {\r\n     this.router.navigate(['/customer/products']);\r\n   }\r\n }\r\n \r\n+\r\n"
                },
                {
                    "date": 1763390112210,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,18 +96,11 @@\n \r\n     try {\r\n       const chatId = await this.chatService.getOrCreateChat(\r\n         user.userId!,\r\n+        user.name || user.email,\r\n         this.product.sellerId,\r\n-        {\r\n-          name: user.name || user.email,\r\n-          role: user.role,\r\n-          profileImage: user.profileImage\r\n-        },\r\n-        {\r\n-          name: this.product.sellerName,\r\n-          role: 'seller'\r\n-        }\r\n+        this.product.sellerName\r\n       );\r\n       this.router.navigate([`/customer/chat/${chatId}`]);\r\n     } catch (error) {\r\n       console.error('Error creating chat:', error);\r\n"
                },
                {
                    "date": 1763640119198,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,11 +78,31 @@\n         sellerId: this.product.sellerId,\r\n         sellerName: this.product.sellerName\r\n       };\r\n       await this.cartService.addToCart(cartItem);\r\n-      this.router.navigate(['/customer/cart']);\r\n+      \r\n+      // Show success toast\r\n+      const toast = document.createElement('ion-toast');\r\n+      toast.message = `✅ ${this.product.title} added to cart!`;\r\n+      toast.duration = 2000;\r\n+      toast.color = 'success';\r\n+      toast.position = 'top';\r\n+      document.body.appendChild(toast);\r\n+      await toast.present();\r\n+      \r\n+      // Navigate after a brief delay\r\n+      setTimeout(() => {\r\n+        this.router.navigate(['/customer/cart']);\r\n+      }, 500);\r\n     } catch (error) {\r\n       console.error('Error adding to cart:', error);\r\n+      const toast = document.createElement('ion-toast');\r\n+      toast.message = 'Failed to add to cart';\r\n+      toast.duration = 2000;\r\n+      toast.color = 'danger';\r\n+      toast.position = 'top';\r\n+      document.body.appendChild(toast);\r\n+      await toast.present();\r\n     }\r\n   }\r\n \r\n   async messageSeller() {\r\n"
                },
                {
                    "date": 1764588866278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import { Component, OnInit } from '@angular/core';\r\n import { CommonModule } from '@angular/common';\r\n import { FormsModule } from '@angular/forms';\r\n-import { IonicModule } from '@ionic/angular';\r\n+import { IonicModule, AlertController } from '@ionic/angular';\r\n import { ActivatedRoute, Router } from '@angular/router';\r\n import { ProductService } from '../../../../services/product.service';\r\n import { CartService } from '../../../../services/cart.service';\r\n import { ChatService } from '../../../../services/chat.service';\r\n@@ -27,9 +27,10 @@\n     private router: Router,\r\n     private productService: ProductService,\r\n     private cartService: CartService,\r\n     private chatService: ChatService,\r\n-    private authService: AuthService\r\n+    private authService: AuthService,\r\n+    private alertController: AlertController\r\n   ) { }\r\n \r\n   ngOnInit() {\r\n     const productId = this.route.snapshot.paramMap.get('id');\r\n@@ -79,21 +80,30 @@\n         sellerName: this.product.sellerName\r\n       };\r\n       await this.cartService.addToCart(cartItem);\r\n       \r\n-      // Show success toast\r\n-      const toast = document.createElement('ion-toast');\r\n-      toast.message = `✅ ${this.product.title} added to cart!`;\r\n-      toast.duration = 2000;\r\n-      toast.color = 'success';\r\n-      toast.position = 'top';\r\n-      document.body.appendChild(toast);\r\n-      await toast.present();\r\n+      // Show success modal with checkout option\r\n+      const alert = await this.alertController.create({\r\n+        header: '✅ Added to Cart!',\r\n+        message: `${this.product.title} has been added to your cart successfully.`,\r\n+        buttons: [\r\n+          {\r\n+            text: 'Continue Shopping',\r\n+            role: 'cancel',\r\n+            handler: () => {\r\n+              this.router.navigate(['/customer/products']);\r\n+            }\r\n+          },\r\n+          {\r\n+            text: 'Checkout Now',\r\n+            handler: () => {\r\n+              this.router.navigate(['/customer/cart']);\r\n+            }\r\n+          }\r\n+        ]\r\n+      });\r\n       \r\n-      // Navigate after a brief delay\r\n-      setTimeout(() => {\r\n-        this.router.navigate(['/customer/cart']);\r\n-      }, 500);\r\n+      await alert.present();\r\n     } catch (error) {\r\n       console.error('Error adding to cart:', error);\r\n       const toast = document.createElement('ion-toast');\r\n       toast.message = 'Failed to add to cart';\r\n"
                }
            ],
            "date": 1763390046038,
            "name": "Commit-0",
            "content": "import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ProductService } from '../../../../services/product.service';\r\nimport { CartService } from '../../../../services/cart.service';\r\nimport { ChatService } from '../../../../services/chat.service';\r\nimport { AuthService } from '../../../../services/auth.service';\r\nimport { Product } from '../../../../models/product.model';\r\n\r\n@Component({\r\n  selector: 'app-product-detail',\r\n  templateUrl: './product-detail.page.html',\r\n  styleUrls: ['./product-detail.page.scss'],\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, IonicModule]\r\n})\r\nexport class ProductDetailPage implements OnInit {\r\n  product: Product | null = null;\r\n  quantity: number = 1;\r\n  loading: boolean = false;\r\n  selectedImageIndex: number = 0;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private productService: ProductService,\r\n    private cartService: CartService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    const productId = this.route.snapshot.paramMap.get('id');\r\n    if (productId) {\r\n      this.loadProduct(productId);\r\n    }\r\n  }\r\n\r\n  async loadProduct(productId: string) {\r\n    this.loading = true;\r\n    try {\r\n      this.product = await this.productService.getProductById(productId);\r\n    } catch (error) {\r\n      console.error('Error loading product:', error);\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  incrementQuantity() {\r\n    if (this.product && this.quantity < this.product.stock) {\r\n      this.quantity++;\r\n    }\r\n  }\r\n\r\n  decrementQuantity() {\r\n    if (this.quantity > 1) {\r\n      this.quantity--;\r\n    }\r\n  }\r\n\r\n  selectImage(index: number) {\r\n    this.selectedImageIndex = index;\r\n  }\r\n\r\n  async addToCart() {\r\n    if (!this.product) return;\r\n    \r\n    try {\r\n      const cartItem = {\r\n        productId: this.product.productId!,\r\n        productName: this.product.title,\r\n        productImage: this.product.images[0] || '',\r\n        price: this.product.price,\r\n        quantity: this.quantity,\r\n        sellerId: this.product.sellerId,\r\n        sellerName: this.product.sellerName\r\n      };\r\n      await this.cartService.addToCart(cartItem);\r\n      this.router.navigate(['/customer/cart']);\r\n    } catch (error) {\r\n      console.error('Error adding to cart:', error);\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/customer/products']);\r\n  }\r\n}\r\n\r\n"
        }
    ]
}