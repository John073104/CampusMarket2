{
    "sourceFile": "src/app/modules/customer/pages/products/products.page.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1764508413246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764588866224,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import { Component, OnInit } from '@angular/core';\r\n import { CommonModule } from '@angular/common';\r\n import { FormsModule } from '@angular/forms';\r\n-import { IonicModule } from '@ionic/angular';\r\n+import { IonicModule, AlertController } from '@ionic/angular';\r\n import { Router } from '@angular/router';\r\n import { ProductService } from '../../../../services/product.service';\r\n import { CartService } from '../../../../services/cart.service';\r\n import { Product } from '../../../../models/product.model';\r\n@@ -24,9 +24,10 @@\n \r\n   constructor(\r\n     private productService: ProductService,\r\n     private cartService: CartService,\r\n-    private router: Router\r\n+    private router: Router,\r\n+    private alertController: AlertController\r\n   ) { }\r\n \r\n   ngOnInit() {\r\n     this.loadProducts();\r\n@@ -94,9 +95,28 @@\n         sellerId: product.sellerId,\r\n         sellerName: product.sellerName\r\n       };\r\n       await this.cartService.addToCart(cartItem);\r\n-      // Show success toast\r\n+      \r\n+      // Show success modal with checkout option\r\n+      const alert = await this.alertController.create({\r\n+        header: 'âœ… Added to Cart!',\r\n+        message: `${product.title} has been added to your cart successfully.`,\r\n+        buttons: [\r\n+          {\r\n+            text: 'Continue Shopping',\r\n+            role: 'cancel'\r\n+          },\r\n+          {\r\n+            text: 'Checkout Now',\r\n+            handler: () => {\r\n+              this.router.navigate(['/customer/cart']);\r\n+            }\r\n+          }\r\n+        ]\r\n+      });\r\n+      \r\n+      await alert.present();\r\n     } catch (error) {\r\n       console.error('Error adding to cart:', error);\r\n     }\r\n   }\r\n"
                }
            ],
            "date": 1764508413246,
            "name": "Commit-0",
            "content": "import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { Router } from '@angular/router';\r\nimport { ProductService } from '../../../../services/product.service';\r\nimport { CartService } from '../../../../services/cart.service';\r\nimport { Product } from '../../../../models/product.model';\r\n\r\n@Component({\r\n  selector: 'app-products',\r\n  templateUrl: './products.page.html',\r\n  styleUrls: ['./products.page.scss'],\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, IonicModule]\r\n})\r\nexport class ProductsPage implements OnInit {\r\n  products: Product[] = [];\r\n  filteredProducts: Product[] = [];\r\n  categories: string[] = ['All', 'Food', 'Snacks', 'Accessories', 'Books', 'Electronics', 'Clothing', 'Other'];\r\n  selectedCategory: string = 'All';\r\n  searchTerm: string = '';\r\n  loading: boolean = false;\r\n\r\n  constructor(\r\n    private productService: ProductService,\r\n    private cartService: CartService,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.loadProducts();\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.loadProducts();\r\n  }\r\n\r\n  async loadProducts() {\r\n    this.loading = true;\r\n    try {\r\n      console.log('Loading approved products for customers...');\r\n      this.products = await this.productService.getApprovedProducts();\r\n      console.log('Loaded products:', this.products.length, this.products);\r\n      this.filteredProducts = [...this.products];\r\n      \r\n      if (this.products.length === 0) {\r\n        console.warn('No approved products found. Check if products are approved in admin panel.');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error loading products:', error);\r\n      console.error('Error code:', error.code);\r\n      console.error('Error message:', error.message);\r\n      \r\n      if (error.code === 'permission-denied') {\r\n        console.error('FIRESTORE PERMISSION DENIED! Please deploy firestore.rules to Firebase.');\r\n        console.error('Run: firebase deploy --only firestore:rules');\r\n      }\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  filterProducts() {\r\n    this.filteredProducts = this.products.filter(product => {\r\n      const matchesCategory = this.selectedCategory === 'All' || product.category === this.selectedCategory;\r\n      const matchesSearch = product.title.toLowerCase().includes(this.searchTerm.toLowerCase()) ||\r\n                           product.description.toLowerCase().includes(this.searchTerm.toLowerCase());\r\n      return matchesCategory && matchesSearch;\r\n    });\r\n  }\r\n\r\n  onCategoryChange() {\r\n    this.filterProducts();\r\n  }\r\n\r\n  onSearchChange() {\r\n    this.filterProducts();\r\n  }\r\n\r\n  viewProduct(productId: string) {\r\n    this.router.navigate(['/customer/product-detail', productId]);\r\n  }\r\n\r\n  async addToCart(product: Product, event: Event) {\r\n    event.stopPropagation();\r\n    try {\r\n      const cartItem = {\r\n        productId: product.productId!,\r\n        productName: product.title,\r\n        productImage: product.images[0] || '',\r\n        price: product.price,\r\n        quantity: 1,\r\n        sellerId: product.sellerId,\r\n        sellerName: product.sellerName\r\n      };\r\n      await this.cartService.addToCart(cartItem);\r\n      // Show success toast\r\n    } catch (error) {\r\n      console.error('Error adding to cart:', error);\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/customer/dashboard']);\r\n  }\r\n}\r\n\r\n"
        }
    ]
}