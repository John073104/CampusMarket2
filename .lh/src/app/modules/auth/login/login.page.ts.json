{
    "sourceFile": "src/app/modules/auth/login/login.page.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1763385225716,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1763385225716,
            "name": "Commit-0",
            "content": "import { Component } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\nimport { AuthService } from '../../../services/auth.service';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, ReactiveFormsModule, IonicModule]\r\n})\r\nexport class LoginPage {\r\n  loginForm: FormGroup;\r\n  showPassword = false;\r\n\r\n  constructor(\r\n    private formBuilder: FormBuilder,\r\n    private authService: AuthService,\r\n    private router: Router,\r\n    private alertController: AlertController,\r\n    private loadingController: LoadingController\r\n  ) {\r\n    this.loginForm = this.formBuilder.group({\r\n      email: ['', [Validators.required, Validators.email]],\r\n      password: ['', [Validators.required, Validators.minLength(6)]]\r\n    });\r\n    \r\n    // Diagnostic: Check Firebase connection\r\n    console.log('Login page loaded');\r\n    console.log('Auth service available:', !!this.authService);\r\n  }\r\n\r\n  togglePasswordVisibility() {\r\n    this.showPassword = !this.showPassword;\r\n  }\r\n\r\n  async onLogin() {\r\n    if (this.loginForm.valid) {\r\n      const loading = await this.loadingController.create({\r\n        message: 'Logging in...',\r\n      });\r\n      await loading.present();\r\n\r\n      try {\r\n        const { email, password } = this.loginForm.value;\r\n        console.log('Login form submitted:', email);\r\n        await this.authService.signIn(email, password);\r\n        await loading.dismiss();\r\n        console.log('Login successful, redirecting...');\r\n      } catch (error: any) {\r\n        await loading.dismiss();\r\n        console.error('Login failed in component:', error);\r\n        \r\n        const alert = await this.alertController.create({\r\n          header: 'Login Failed',\r\n          message: error?.message || 'Invalid credentials. Please try again.',\r\n          buttons: ['OK']\r\n        });\r\n        await alert.present();\r\n      }\r\n    }\r\n  }\r\n\r\n  goToSignup() {\r\n    this.router.navigate(['/auth/signup']);\r\n  }\r\n\r\n  async forgotPassword() {\r\n    const alert = await this.alertController.create({\r\n      header: 'Reset Password',\r\n      message: 'Enter your email address to receive a password reset link.',\r\n      inputs: [\r\n        {\r\n          name: 'email',\r\n          type: 'email',\r\n          placeholder: 'Email address'\r\n        }\r\n      ],\r\n      buttons: [\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel'\r\n        },\r\n        {\r\n          text: 'Send Reset Link',\r\n          handler: async (data) => {\r\n            if (data.email) {\r\n              const loading = await this.loadingController.create({\r\n                message: 'Sending reset link...',\r\n              });\r\n              await loading.present();\r\n\r\n              try {\r\n                await this.authService.resetPassword(data.email);\r\n                await loading.dismiss();\r\n                \r\n                const successAlert = await this.alertController.create({\r\n                  header: 'Success',\r\n                  message: 'Password reset link has been sent to your email.',\r\n                  buttons: ['OK']\r\n                });\r\n                await successAlert.present();\r\n              } catch (error: any) {\r\n                await loading.dismiss();\r\n                const errorAlert = await this.alertController.create({\r\n                  header: 'Error',\r\n                  message: 'Failed to send reset link. Please check your email address.',\r\n                  buttons: ['OK']\r\n                });\r\n                await errorAlert.present();\r\n              }\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/landing']);\r\n  }\r\n}"
        }
    ]
}