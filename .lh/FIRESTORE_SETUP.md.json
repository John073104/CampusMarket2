{
    "sourceFile": "FIRESTORE_SETUP.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764508413245,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764508413245,
            "name": "Commit-0",
            "content": "# üî• Firestore Security Rules Setup Guide\r\n\r\n## ‚ùå Problem: \"Missing or Insufficient Permissions\" Error\r\n\r\nThis error occurs because your Firestore database doesn't have security rules configured. Without rules, Firestore denies all read/write operations.\r\n\r\n---\r\n\r\n## ‚úÖ Solution: Deploy Firestore Security Rules\r\n\r\n### **Option 1: Deploy via Firebase Console (Easiest)**\r\n\r\n1. **Go to Firebase Console**\r\n   - Visit: https://console.firebase.google.com/\r\n   - Select your project: `surveyform-6c48b`\r\n\r\n2. **Navigate to Firestore Database**\r\n   - Click on **\"Firestore Database\"** in the left sidebar\r\n   - Click on **\"Rules\"** tab at the top\r\n\r\n3. **Copy and Paste Rules**\r\n   - Open the `firestore.rules` file in your project\r\n   - Copy ALL the content\r\n   - Paste it into the Firebase Console rules editor\r\n\r\n4. **Publish Rules**\r\n   - Click **\"Publish\"** button\r\n   - Wait for confirmation message\r\n\r\n5. **Test Your App**\r\n   - Try logging in again\r\n   - Products should now load\r\n\r\n---\r\n\r\n### **Option 2: Deploy via Firebase CLI (Recommended for Production)**\r\n\r\n#### Step 1: Install Firebase CLI (if not installed)\r\n```powershell\r\nnpm install -g firebase-tools\r\n```\r\n\r\n#### Step 2: Login to Firebase\r\n```powershell\r\nfirebase login\r\n```\r\n\r\n#### Step 3: Initialize Firebase in Your Project\r\n```powershell\r\ncd C:\\Users\\ACER\\Dropbox\\PC\\Downloads\\CampusMarket\r\nfirebase init\r\n```\r\n\r\n**During initialization:**\r\n- Select: **Firestore** (use spacebar to select)\r\n- Choose: **Use an existing project**\r\n- Select: **surveyform-6c48b**\r\n- Firestore rules file: **firestore.rules** (already exists)\r\n- Firestore indexes file: **firestore.indexes.json** (press Enter)\r\n\r\n#### Step 4: Deploy Rules\r\n```powershell\r\nfirebase deploy --only firestore:rules\r\n```\r\n\r\n#### Step 5: Verify Deployment\r\nYou should see:\r\n```\r\n‚úî  Deploy complete!\r\n```\r\n\r\n---\r\n\r\n## üìã What the Security Rules Do\r\n\r\n### **Authentication Required**\r\n- All operations require users to be logged in (authenticated)\r\n- Anonymous access is denied\r\n\r\n### **Role-Based Access Control**\r\n- **Customers** can:\r\n  - Read approved products\r\n  - Create orders\r\n  - Chat with sellers\r\n  - Apply to become seller\r\n\r\n- **Sellers** can:\r\n  - Create/edit/delete their own products\r\n  - Manage orders for their products\r\n  - Chat with customers\r\n\r\n- **Admins** can:\r\n  - Read/update/delete all data\r\n  - Approve/reject products\r\n  - Approve/reject seller applications\r\n  - View all chats and orders\r\n\r\n### **Data Privacy**\r\n- Users can only see their own orders\r\n- Sellers can only edit their own products\r\n- Chat participants can only see their own conversations\r\n- Admins have full access for management\r\n\r\n---\r\n\r\n## üß™ Testing After Deployment\r\n\r\n### 1. **Test Login**\r\n```\r\n- Email: test@customer.com\r\n- Password: password123\r\n```\r\nShould successfully log in without permission errors.\r\n\r\n### 2. **Test Products Page**\r\n- Navigate to Customer ‚Üí Products\r\n- Should display approved products (if any exist)\r\n- If no products show, create some as seller or approve existing as admin\r\n\r\n### 3. **Test Orders**\r\n- Add product to cart\r\n- Place order\r\n- Should successfully create order\r\n\r\n---\r\n\r\n## ‚ö†Ô∏è Common Issues & Solutions\r\n\r\n### Issue 1: Still Getting Permission Denied\r\n**Solution:**\r\n- Wait 30-60 seconds after deployment\r\n- Clear browser cache (Ctrl + Shift + Delete)\r\n- Logout and login again\r\n- Hard refresh (Ctrl + F5)\r\n\r\n### Issue 2: Firebase CLI Not Found\r\n**Solution:**\r\n```powershell\r\nnpm install -g firebase-tools\r\n# Restart PowerShell after installation\r\n```\r\n\r\n### Issue 3: Wrong Firebase Project\r\n**Solution:**\r\n```powershell\r\nfirebase use surveyform-6c48b\r\nfirebase deploy --only firestore:rules\r\n```\r\n\r\n### Issue 4: Products Not Showing for Customers\r\n**Reasons:**\r\n1. No products exist ‚Üí Create products as seller\r\n2. Products not approved ‚Üí Approve as admin\r\n3. Rules not deployed ‚Üí Deploy firestore.rules\r\n4. User not logged in ‚Üí Check authentication\r\n\r\n**Check Console:**\r\n- Open browser DevTools (F12)\r\n- Go to Console tab\r\n- Look for errors or warnings\r\n- Check Network tab for failed requests\r\n\r\n---\r\n\r\n## üìä Firestore Collections Used\r\n\r\nYour app uses these collections:\r\n- `users` - User profiles (customer, seller, admin)\r\n- `products` - Product listings\r\n- `orders` - Order transactions\r\n- `chats` - Chat rooms\r\n- `chats/{chatId}/messages` - Chat messages\r\n- `sellerApplications` - Seller approval requests\r\n\r\nAll are now protected by security rules!\r\n\r\n---\r\n\r\n## üîç Verify Rules are Active\r\n\r\n### Method 1: Firebase Console\r\n1. Go to https://console.firebase.google.com/\r\n2. Select project ‚Üí Firestore Database ‚Üí Rules\r\n3. Check \"Last published\" timestamp\r\n\r\n### Method 2: Test in Browser Console\r\n```javascript\r\n// Open browser console (F12) on your app\r\n// Try to read a document (should work when logged in)\r\n```\r\n\r\n---\r\n\r\n## üìù Next Steps After Deployment\r\n\r\n1. ‚úÖ Deploy firestore.rules (required immediately)\r\n2. ‚úÖ Create test user accounts\r\n3. ‚úÖ Create sample products as seller\r\n4. ‚úÖ Approve products as admin\r\n5. ‚úÖ Test customer flow (browse, cart, order)\r\n6. ‚úÖ Test seller flow (create product, manage orders)\r\n7. ‚úÖ Test admin flow (approve products, users, applications)\r\n\r\n---\r\n\r\n## üÜò Still Having Issues?\r\n\r\n### Enable Debug Logging\r\nAdd to your `auth.service.ts`:\r\n```typescript\r\nconsole.log('Current user:', this.getCurrentUser());\r\nconsole.log('Auth state:', this.auth.currentUser);\r\n```\r\n\r\n### Check Firestore Status\r\nVisit: https://status.firebase.google.com/\r\n\r\n### Contact Support\r\n- Check Firebase community forum\r\n- Review Firestore documentation\r\n- Check browser console for detailed errors\r\n\r\n---\r\n\r\n## üéØ Production Deployment Checklist\r\n\r\nBefore going to production:\r\n- [ ] Deploy firestore.rules\r\n- [ ] Deploy firestore indexes (if using complex queries)\r\n- [ ] Enable billing on Firebase project\r\n- [ ] Set up backups\r\n- [ ] Configure monitoring and alerts\r\n- [ ] Test all user roles thoroughly\r\n- [ ] Review security rules for your use case\r\n- [ ] Set up proper error handling\r\n- [ ] Configure CORS for production domain\r\n\r\n---\r\n\r\n**After deploying the rules, your app should work without permission errors! üéâ**\r\n"
        }
    ]
}